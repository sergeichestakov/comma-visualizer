# Comma Speed Visualizer

## Overview
At a high level, this application displays a map that allows a user to input a date and visualizes the distribution of speeds from all trips recorded on that date.

Here is a brief rundown of how it works: 

#### Preprocessing
* parse.py in the python directory iterates through all of the provided json files and generates a dictionary with a key of the date (extracted from filename) and a value of an array of each of the json objects (serialized as strings) that correspond to trips recorded that day
* populate.py then takes the dictionary generated by parse.py and populates an SQLite database with it`which the app will later interface with

#### Application Logic
* The app starts by running a Flask server which serves the html page found in the templates directory when users access the root url 
* After a user selects a date from the input form, the webpage makes a post request back to the Flask server at the route '/process' with the input date encoded as JSON
* The flask server then takes that date and queries the database for all trips taken on that date and returns the array of results back to the front end as JSON
* The application then parses the JSON, extracts all of the necessary information, and then renders each of the points on the map
* The mapbox API allows for rendering different colors depending on the speed as well as generating popups with more information when a point is clicked
* The process then resets and repeats with every subsequent request a user makes.

## Design Decisions
From the beginning, I knew that I wanted the front end of the application to be a simple UI with a full screen map and an input for a specific date. 

As a result, I felt like a framework like React would be overkill as it is quite heavy and would not prove useful in this case. 

I decided to go with Mapbox because I had used it before and knew its API would be perfect for the kind of dynamic conditional rendering I would need to do for this project. 

On the backend, I went with Flask to serve the html and respond to requests. I had never used Flask before, but was already using Python to parse all the JSON files so I figured it would be easier to interface and a good learning experience.

Finally, I knew I would have to store the data in a database for easy lookup and serverside processing so I decided to use SQLite because it of its simplicity and serverless nature.

One thing to note is that I limited the dates a user can select to be between 01/28/2017 and 10/04/2017 because that is the most consistent range of dates in the dataset.

## Installation
Make sure you are using Python 3.6 or higher

```bash
# Set up virtual env
pip3 install virtualenv
virtualenv env
. env/bin/activate 

# Install requirements
pip3 install -r requirements.txt

# Export flask app variable
export FLASK_APP=app.py

# Run the app
flask run
```
